---
phase: 01-quick-wins-securite
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/store/todoStore.ts
  - src/store/dashboardStore.ts
  - src/store/weatherStore.ts
  - src/store/calendarStore.ts
  - src/store/financeStore.ts
  - src/store/notesStore.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Développeur peut accéder aux stores via window.__ZUSTAND_STORES__ en mode développement"
    - "Chaque store est exposé avec son nom (todos, dashboard, weather, etc.)"
    - "L'accès aux stores est disponible uniquement en mode DEV"
  artifacts:
    - path: "window.__ZUSTAND_STORES__"
      provides: "Global access to Zustand stores for debugging"
      contains: "todos, dashboard, weather, calendar, finance, notes stores"
    - path: "src/store/*.ts"
      provides: "Store files modified to expose themselves"
      contains: "if (import.meta.env.DEV) block"
  key_links:
    - from: "src/store/*.ts"
      to: "window.__ZUSTAND_STORES__"
      via: "Conditional assignment in dev mode"
      pattern: "if \\(import\\.meta\\.env\\.(DEV|MODE.*development\\)\\).*window\\.__ZUSTAND_STORES__"
---

<objective>
Exposer les stores Zustand pour le débogage en mode développement

Purpose: Permettre l'inspection de l'état des stores via DevTools pour faciliter le développement
Output: Tous les stores accessibles via `window.__ZUSTAND_STORES__` en mode dev uniquement
</objective>

<execution_context>
@/home/orion/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/orion/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-quick-wins-securite/01-CONTEXT.md
@.planning/phases/01-quick-wins-securite/01-RESEARCH.md

# Store Files to Modify
- src/store/todoStore.ts
- src/store/dashboardStore.ts
- src/store/weatherStore.ts
- src/store/calendarStore.ts
- src/store/financeStore.ts
- src/store/notesStore.ts

# Pattern from CONTEXT.md (Decisions)
- **Data visibility:** Stores accessible pour inspection
- **Interface style:** Browser DevTools panel integration (pas de widget flottant)
- **Available actions:** Read-only inspection uniquement (pas de reset, time-travel, modifications)
- **Multiple stores:** Tabbed interface (onglet séparé pour chaque store)
</context>

<tasks>

<task type="auto">
  <name>Exposer tous les stores Zustand à window.__ZUSTAND_STORES__</name>
  <files>src/store/*.ts</files>
  <action>
    Pour chaque fichier de store (todoStore.ts, dashboardStore.ts, weatherStore.ts, calendarStore.ts, financeStore.ts, notesStore.ts):

    1. Ajouter après la création du store:
    ```typescript
    // Expose store for debugging in development only
    if (import.meta.env.DEV) {
      (window as any).__ZUSTAND_STORES__ = (window as any).__ZUSTAND_STORES__ || {};
      const storeName = 'todos' | 'dashboard' | 'weather' | 'calendar' | 'finance' | 'notes';
      (window as any).__ZUSTAND_STORES__[storeName] = use{StoreName}Store;
    }
    ```

    Utiliser le nom approprié pour chaque store:
    - todoStore.ts → 'todos'
    - dashboardStore.ts → 'dashboard'
    - weatherStore.ts → 'weather'
    - calendarStore.ts → 'calendar'
    - financeStore.ts → 'finance'
    - notesStore.ts → 'notes'

    2. S'assurer que le cast `(window as any)` est utilisé pour éviter les erreurs TypeScript

    Ne PAS exposer les stores en production (le bloc `if (import.meta.env.DEV)` s'assure de cela).
  </action>
  <verify>
    Vérifier que chaque fichier de store contient le bloc d'exposition conditionnelle:
    ```bash
    grep -l "window.__ZUSTAND_STORES__" src/store/*.ts
    ```
    Doit retourner tous les 6 fichiers de stores.

    Vérifier que le code est bien dans un bloc conditionnel DEV:
    ```bash
    grep -A1 "window.__ZUSTAND_STORES__" src/store/todoStore.ts | grep "import.meta.env.DEV"
    ```
  </verify>
  <done>
    Tous les stores sont exposés via `window.__ZUSTAND_STORES__` en mode développement uniquement
  </done>
</task>

</tasks>

<verification>
- [ ] Toutes les stores (todos, dashboard, weather, calendar, finance, notes) sont accessibles via `window.__ZUSTAND_STORES__`
- [ ] L'exposition est conditionnée à `import.meta.env.DEV`
- [ ] Chaque store utilise son propre nom comme clé dans l'objet global
- [ ] Le code TypeScript compile sans erreur (cast `window as any`)
</verification>

<success_criteria>
**Observable:** Dans la console DevTools en mode développement:
```javascript
Object.keys(window.__ZUSTAND_STORES__)
// ['todos', 'dashboard', 'weather', 'calendar', 'finance', 'notes']

window.__ZUSTAND_STORES__.todos.getState()
// { todos: [...], addTodo: fn(), ... }
```

**Measurable:**
- 6 fichiers de stores modifiés
- 0 exposition en production
- 100% des stores accessibles en développement
</success_criteria>

<output>
After completion, create `.planning/phases/01-quick-wins-securite/01-01-SUMMARY.md`
</output>
